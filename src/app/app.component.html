<md-sidenav-layout class="app-sidenav-layout">
  <md-sidenav #sidenav mode="side" class="app-sidenav">
    <button md-button (click)="menuSelected='importDir'">Create new database</button><br>
    <button md-button (click)="menuSelected='importDb'">Import database</button><br><br>
    <hr>
    <div *ngIf="collection && collection.length>0">
      <button md-button (click)="menuSelected=null">Select databases:</button><br>
      <md-list dense>
        <md-list-item *ngFor="let item of collection">
          <button
            [attr.md-button]="(item.name != databaseSelected)?true:null"
            [attr.md-raised-button]="(item.name == databaseSelected)?true:null"
            (click)="selectDatabase(item.name)"
          >{{item.name}}</button>
        </md-list-item>
        <div *ngIf="!collection">
          <button md-button>No databases imported</button>
        </div>
      </md-list>
    </div>
    <div *ngIf="!(collection && collection.length>0)">
      <!-- Eventually request for import -->
    </div>
  </md-sidenav>

  <md-toolbar color="primary">
    <button class="app-icon-button" (click)="sidenav.toggle()">
      <i class="material-icons app-toolbar-menu">menu</i>
    </button>
    Cryptarsi APP
    <span class="app-toolbar-filler"></span>
  </md-toolbar>

  <div class="app-content">
    <span [ngSwitch]="menuSelected">
      <span *ngSwitchCase="'importDb'">
        <app-import-db (onImport)="importedDir()"></app-import-db>
      </span>
      <span *ngSwitchCase="'importDir'">
        <app-import-dir (onImport)="importedDir()"></app-import-dir>
      </span>
      <span *ngSwitchDefault>
          <md-card *ngIf="!databaseSelected">
             <button md-button class="md-button md-raised" (click)="menuSelected='importDir'">Create new database from directory</button><br>
              <button md-button class="md-button md-raised" (click)="menuSelected='importDb'">Import database from file</button><br>
             <button md-button class="md-button md-raised" (click)="sidenav.toggle()">Select database</button>
              <P>CRYPTARSI is a system designed to produce, search and browse encrypted data sets. The encrypted data can be shared on unsecured servers.
	<P>Cryptarsi is an open source project available on <a href="https://github.com/bivol/cryptarsi" target="_blank">Github</a>.
	<P>The system may be useful in different fields, requiring data protection: investigative journalism, human rights activism in dictatorial countries, corporate security, etc.
	<P> The name Cryptarsi comes from the Latin word "Crypto" and the Bulgarian word "Tarsi", meaning "search".
	<P> Cryptarsi is an open source project supported by Google <a href="https://www.digitalnewsinitiative.com/" target="_blank">Digital News Initiative Fund</a>
	<P>If you want to contribute to the development of Cryptarsi join us on <a href="https://github.com/bivol/cryptarsi" target="_blank">Github</a>
	<P>Requirements: <a href="http://www.chrome.com" target="_blank">Chrome</a> browser. The Firefox version is not fully operational.
	<P>Howto: Prepare your data. Create a folder for your story. Inside this folder create one folder for each lead. Put the files for each lead in their folder. For each folder create one plain text file (UTF-8 encoded) named exactly after the folder. Write or copy-paste the description of your lead in the text file.  Don't forget the .txt extension. Then import the story folder with the button <a href="#" (click)="menuSelected='importDir'">Create new database</a> Give a name to the database, write a strong password, select the folder with the story and click on "Encrypt and Import". You can also import some test data from this <a href="http://cryptarsi.org/cryptarsi_test_data.tar">file</a>. Download the <a href="http://cryptarsi.org/cryptarsi_test_data.tar">file</a>, click on Import Database from File, give a name to the database, select the downloaded tar file and import it. The password for the test database is simply: test.

	<P>An early version of the system was used by the journalists from <a href="http://www.bivol.bg" target="_blank">Bivol.bg</a> while working on the <a href="https://en.wikipedia.org/wiki/United_States_diplomatic_cables_leak" target="_blank">Cablegate</a> releases of <a href="https://www.wikileaks.org" target="_blank">Wikileaks</a> from different locations.
          </md-card>

          <div *ngIf="databaseSelected">
            <!--<div>Database selected: {{databaseSelected.name}}</div>-->
            <div *ngFor="let item of collection">
              <app-search-page
                [hidden]="item.name!=databaseSelected"
                [database]="item.name"
                (onDrop)="clearSelection()"
              >

              </app-search-page>

            </div>

          </div>

      </span>
    </span>

  </div>

</md-sidenav-layout>

<!--
<span class="app-action">
  <button md-fab><md-icon>check circle</md-icon></button>
</span>
-->
